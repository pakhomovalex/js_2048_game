const t=document.querySelector(".message-start"),e=document.querySelector(".message-lose"),s=document.querySelector(".message-win"),r=new class{#t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];#e(t){return t.map(t=>[...t])}constructor(t=this.#e(this.#t)){this.matrix=t,this.status="idle",this.score=0}moveLeft(){if("playing"!==this.getStatus())return;let t=!1;this.matrix=this.matrix.map(e=>{for(let s=1;s<4;s++)for(;0===e[s-1]&&0!==e[s];)e[s-1]=e[s],e[s]=0,t=!0,s--;for(let s=1;s<e.length;s++)e[s]===e[s-1]&&0!==e[s]&&(e[s-1]=e[s]+e[s-1],this.score+=e[s-1],e[s]=0,t=!0,s--);for(let s=1;s<4;s++)for(;0===e[s-1]&&0!==e[s];)e[s-1]=e[s],e[s]=0,t=!0,s--;return e}),t&&this.createRandomTile(),this.drawTiles(),this.getStatus(),this.winOrLose()}moveRight(){if("playing"!==this.getStatus())return;let t=!1;this.matrix=this.matrix.map(e=>{for(let s=2;s>=0;s--)for(;0===e[s+1]&&0!==e[s];)e[s+1]=e[s],e[s]=0,t=!0,s++;for(let s=e.length-2;s>=0;s--)e[s]===e[s+1]&&0!==e[s]&&(e[s+1]=e[s]+e[s+1],this.score+=e[s+1],e[s]=0,t=!0,s++);for(let s=2;s>=0;s--)for(;0===e[s+1]&&0!==e[s];)e[s+1]=e[s],e[s]=0,t=!0,s++;return e}),t&&this.createRandomTile(),this.drawTiles(),this.getStatus(),this.winOrLose()}moveUp(){if("playing"!==this.getStatus())return;let t=!1,e=this.getMatrixGroupedByCols().map(e=>{for(let s=1;s<4;s++)for(;0===e[s-1]&&0!==e[s];)e[s-1]=e[s],e[s]=0,t=!0,s--;for(let s=1;s<e.length;s++)e[s]===e[s-1]&&0!==e[s]&&(e[s-1]=e[s]+e[s-1],this.score+=e[s-1],e[s]=0,t=!0,s--);for(let s=1;s<4;s++)for(;0===e[s-1]&&0!==e[s];)e[s-1]=e[s],e[s]=0,t=!0,s--;return e});for(let t=0;t<4;t++)for(let s=0;s<4;s++)this.matrix[t][s]=e[s][t];t&&this.createRandomTile(),this.drawTiles(),this.getStatus(),this.winOrLose()}moveDown(){if("playing"!==this.getStatus())return;let t=!1,e=this.getMatrixGroupedByCols().map(e=>{for(let s=2;s>=0;s--)for(;0===e[s+1]&&0!==e[s];)t=!0,e[s+1]=e[s],e[s]=0,s++;for(let s=e.length-2;s>=0;s--)e[s]===e[s+1]&&0!==e[s]&&(t=!0,e[s+1]=e[s]+e[s+1],this.score+=e[s+1],e[s]=0,s++);for(let s=2;s>=0;s--)for(;0===e[s+1]&&0!==e[s];)t=!0,e[s+1]=e[s],e[s]=0,s++;return e});for(let t=0;t<4;t++)for(let s=0;s<4;s++)this.matrix[t][s]=e[s][t];t&&this.createRandomTile(),this.drawTiles(),this.getStatus(),this.winOrLose()}getScore(){return this.score}getState(){return this.matrix}getStatus(){switch(this.status){case"idle":t.classList.remove("hidden"),e.classList.add("hidden"),s.classList.add("hidden");break;case"playing":t.classList.add("hidden"),e.classList.add("hidden"),s.classList.add("hidden");break;case"win":s.classList.remove("hidden");break;case"lose":e.classList.remove("hidden")}return this.status}start(){this.createRandomTile(),this.createRandomTile(),this.status="playing",this.getStatus()}restart(){this.matrix=this.#e(this.#t),this.status="idle",this.getStatus(),this.clearMatrix()}createRandomTile(){let t=.9>Math.random()?2:4,e=[];for(let t=0;t<4;t++)for(let s=0;s<4;s++)0===this.matrix[t][s]&&e.push([t,s]);let s=Math.floor(Math.random()*e.length),r=e[s];this.matrix[r[0]][r[1]]=t;let i=document.querySelector(`.field-row:nth-child(${r[0]+1})`).querySelector(`.field-cell:nth-child(${r[1]+1})`);i.textContent=t,i.classList.add(`field-cell--${t}`),i.style.transition=".5s"}getMatrixGroupedByCols(){let t=this.#e(this.#t);for(let e=0;e<4;e++)for(let s=0;s<4;s++)t[s][e]=this.matrix[e][s];return t}clearMatrix(){for(let t=0;t<4;t++)for(let e=0;e<4;e++){let s=document.querySelector(`.field-row:nth-child(${t+1})`).querySelector(`.field-cell:nth-child(${e+1})`);s.textContent="",s.className="field-cell"}}drawTiles(){for(let t=0;t<4;t++)for(let e=0;e<4;e++){let s=document.querySelector(`.field-row:nth-child(${t+1})`).querySelector(`.field-cell:nth-child(${e+1})`);s.textContent="",s.className="field-cell",0!==this.matrix[t][e]&&(s.textContent=`${this.matrix[t][e]}`,s.classList.add(`field-cell--${this.matrix[t][e]}`))}}movesAvailable(t){let e=t.length;for(let s=0;s<e;s++)for(let r=0;r<e;r++)if(0===t[s][r])return!0;for(let s=0;s<e;s++)for(let r=0;r<e;r++)if(r<e-1&&t[s][r]===t[s][r+1]||s<e-1&&t[s][r]===t[s+1][r])return!0;return!1}winOrLose(){this.movesAvailable(this.matrix)||(this.status="lose");for(let t=0;t<4;t++)for(let e=0;e<4;e++)2048===this.matrix[t][e]&&(this.status="win")}},i=document.querySelector(".start"),a=document.querySelector(".restart"),l=document.querySelector(".game-score"),o=t=>{switch(t.key){case"ArrowUp":r.moveUp();break;case"ArrowLeft":r.moveLeft();break;case"ArrowRight":r.moveRight();break;case"ArrowDown":r.moveDown();break;default:return}l.textContent=r.score};i.addEventListener("click",()=>{i.classList.add("hidden"),a.classList.remove("hidden"),r.start(),document.addEventListener("keydown",o)}),a.addEventListener("click",()=>{a.classList.add("hidden"),i.classList.remove("hidden"),r.restart(),r.score=0,l.textContent=r.score,document.removeEventListener("keydown",o)});
//# sourceMappingURL=index.b0631d3a.js.map
